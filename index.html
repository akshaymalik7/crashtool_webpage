<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Crash Tool</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.41.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.41.0/mapbox-gl.css' rel='stylesheet' />
    <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.4/mapbox-gl-draw.css' type='text/css' />
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.4/mapbox-gl-draw.js'></script>
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="crashesLite.js"></script>
    <script src="CL_99.js"></script>
</head>
<body>

<div id='map'>
  <div id="slidecontainer">
    <input type="range" min="1" max="500" value="50" class="slider" id="myRange">
  </div>
</div>

<script>
//console.log(centerlines);
mapboxgl.accessToken = 'pk.eyJ1IjoibWFwbXlkYXRhIiwiYSI6ImNqOXNtMTR5dzA5bGYycXBsdmFraHRnNnkifQ.vqfvXOyVVQsxxjZpJ99vYQ';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/light-v9',
    center: [-75.15, 40],
    zoom: 11,
    maxzoom: 16,
    minzoom: 11
});

var Draw = new MapboxDraw();
map.addControl(Draw)

console.log(map.getZoom())

map.on('load', function () {

    map.addLayer({
        "id": "centerlines",
        "type": "line",
        "source": {
            "type": "geojson",
            "data": {
                "type": "FeatureCollection",
                "features": centerlines.features
                      }
                  },
        "paint": {
          "line-width": 1,
          "line-color": "#30323D"
                }
            });

    map.addLayer({
        "id": "injurycrashes",
        "type": "circle",
        "source": {
            "type": "geojson",
            "data": {
                "type": "FeatureCollection",
                "features": crashes.features
                      }
                  },
        "paint": {
          "circle-radius": 1,
          "circle-opacity": 0.5,
          "circle-color": "#00A1E4",
          "circle-stroke-width": 1,
          "circle-stroke-color": "#00A1E4"
                }
            });

    map.setMinZoom(11);

});


map.on("zoom", function(){
  console.log(map.getZoom());
  map.setMinZoom(11);
  map.setPaintProperty('injurycrashes', "circle-stroke-width", ["^", 1.05, map.getZoom()])
  function markerResize() {
    if (map.getZoom() < 13) {
      map.setPaintProperty('injurycrashes', "circle-radius", ["^", 1.05, map.getZoom()])
    }

    else if (15 > map.getZoom() > 13) {
      map.setPaintProperty('injurycrashes', "circle-radius", ["^", 1.06, map.getZoom()])
    }

    else if (18 > map.getZoom() > 15) {
      map.setPaintProperty('injurycrashes', "circle-radius", ["^", 1.14, map.getZoom()])
    }
    else {
      map.setPaintProperty('injurycrashes', "circle-radius", ["^", 1.2, map.getZoom()])

    }
  }

  markerResize();


});


</script>

</body>
</html>
